<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üì∞ NetWatch | Home</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root{
      --page-bg:url('https://imgs.search.brave.com/yKevjAUe9_VSjQPkpWXQ3nRdk4vm1j-i7FEMEvo7eZE/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9wbmcu/cG5ndHJlZS5jb20v/dGh1bWJfYmFjay9m/aDI2MC9iYWNrZ3Jv/dW5kLzIwMjIxMDA4/L3BuZ3RyZWUtdXMt/Y2FwaXRvbC1pbi10/aGUtbmlnaHQtcG93/ZXItZ292ZXJubWVu/dC1wb2xpdGljcy1w/aG90by1pbWFnZV82/OTIxODUyLmpwZw');
      --panel:#0b0f14;
      --surface:#111827;
      --ring:#2e3a46;
      --text:#e5e7eb; --muted:#9ca3af; --brand:#60a5fa; --accent:#22d3ee;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; color:var(--text);
         background:var(--page-bg) no-repeat center/cover fixed}

    .gov-banner { background:#f8fafc; color:#111827; border-bottom:1px solid #e5e7eb; font-size:14px; padding:.6rem 1rem; }
    .gov-banner .flag { margin-right:.25rem; }
    .gov-banner a { color:#0a58ca; text-decoration:underline; cursor:pointer; margin-left:.35rem; }
    .gov-dropdown { display:none; background:#fff; color:#111; border-top:1px solid #e5e7eb; padding:1rem; font-size:14px; }
    .gov-dropdown.open { display:block; }

    header{background:var(--panel); border-bottom:3px solid var(--ring); padding:12px 20px; display:flex; align-items:center; justify-content:space-between}
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; font-size:20px; color:var(--brand)}
    .brand img{height:36px; width:auto}
    .clock{font-variant-numeric:tabular-nums; color:var(--muted)}
    .weather{display:flex; align-items:center; gap:8px; color:var(--text); font-size:14px; cursor:pointer}
    .weather .wx-icon{font-size:18px}
    .weather .wx-temp{font-weight:700}
    .weather .wx-place{color:var(--muted)}
    .wx-caret{font-size:12px; color:var(--muted)}
    .weather-panel{position:absolute; right:20px; top:62px; width:320px; background:#0f172a; border:1px solid var(--ring); border-radius:8px; padding:12px; display:none; box-shadow:0 10px 30px rgba(0,0,0,.35); z-index:30}
    .weather-panel.open{display:block}
    .weather-head{display:flex; align-items:center; justify-content:space-between; margin-bottom:8px}
    .unit-toggle{display:flex; gap:6px}
    .unit-toggle button{background:#0b1220; color:var(--text); border:1px solid var(--ring); border-radius:999px; padding:4px 8px; font-size:12px}
    .unit-toggle button.active{border-color:var(--brand); color:var(--brand)}
    .forecast{display:grid; grid-template-columns:repeat(4,1fr); gap:8px; margin-top:8px}
    .chip{background:#0b1220; border:1px solid var(--ring); border-radius:8px; padding:8px; text-align:center}
    .chip .t{font-size:12px; color:var(--muted)}
    .chip .v{font-size:14px; font-weight:600}
    .daily{display:grid; grid-template-columns:repeat(3,1fr); gap:8px; margin-top:8px}
    .daily .row{background:#0b1220; border:1px solid var(--ring); border-radius:8px; padding:8px; text-align:center; font-size:13px}
    .wx-meta{font-size:12px; color:var(--muted)}
    .weather .wx-icon{font-size:18px}
    .weather .wx-temp{font-weight:700}
    .weather .wx-place{color:var(--muted)}

    .topnav{background:var(--surface); border-bottom:2px solid var(--ring); display:flex; gap:18px; padding:10px 16px; justify-content:center}
    .menu{position:relative}
    .menu>a{color:var(--text); text-transform:uppercase; letter-spacing:.05em; font-weight:600; padding:8px 10px; display:inline-block}
    .menu>a:hover{color:var(--brand)}
    .submenu{position:absolute; top:100%; left:0; min-width:220px; background:#0f172a; border:1px solid var(--ring); border-radius:6px; padding:8px; display:none; box-shadow:0 10px 30px rgba(0,0,0,.4)}
    .submenu a{display:block; padding:8px 10px; color:var(--text); border-radius:4px}
    .submenu a:hover{background:#0b1220; color:var(--brand)}
    .menu:focus-within .submenu, .menu:hover .submenu{display:block}

    .container{max-width:1100px; margin:20px auto; padding:20px; border:3px solid var(--ring); border-radius:10px; background:var(--panel); box-shadow:inset 0 0 12px #000}
    .title{font-size:28px; font-weight:800; text-transform:uppercase; text-align:center; color:var(--brand); margin:0 0 4px}
    .subtitle{color:var(--muted); text-align:center; margin:0 0 18px}

    .exec-wrapper{display:grid; grid-template-columns:1fr 1fr; gap:20px;} /* auto-stacks on small screens */
    .exec{display:grid; grid-template-columns:96px 1fr; gap:16px; align-items:center; padding:14px; border:2px solid var(--ring); border-radius:8px; background:var(--surface)}
    .exec img{width:96px; height:96px; border-radius:50%; background:#0b1220; border:1px solid var(--ring)}
    .exec h2{margin:0 0 6px; font-size:14px; color:var(--muted); text-transform:uppercase}
    .grid{display:grid; grid-template-columns:max-content 1fr; column-gap:12px; row-gap:6px; font-size:15px}
    .grid dt{color:var(--muted); text-transform:uppercase; font-size:12px}
    .grid dd{margin:0}

    .live-panel{padding:14px; border:2px solid var(--ring); border-radius:8px; background:var(--surface)}
    .live-panel h2{margin:0 0 10px; font-size:14px; color:var(--muted); text-transform:uppercase}
    .live-panel iframe{width:100%; height:300px; border:none; background:#0b1220}

    .links{display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:14px; margin-top:18px}
    .block{background:var(--surface); border:2px solid var(--ring); border-radius:8px; padding:12px}
    .block h3{margin:0 0 8px; font-size:14px; text-transform:uppercase; color:var(--muted)}
    .block a{display:flex; justify-content:space-between; align-items:center; padding:10px 12px; margin:6px 0; border:1px solid var(--ring); border-radius:6px; color:var(--text)}
    .block a:hover{border-color:var(--brand); color:var(--brand)}
    .ext{font-size:12px; color:var(--muted)}

    footer{margin:30px 0 16px; text-align:center; color:var(--muted)}
      /* Congress directory */
    .congress { margin-top: 20px; padding:14px; border:2px solid var(--ring); border-radius:8px; background:var(--surface); }
    .congress h2 { margin: 0 0 10px; font-size:14px; color:var(--muted); text-transform:uppercase }
    .congress .controls { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px }
    .congress input, .congress select { background:#0f172a; color:var(--text); border:1px solid var(--ring); border-radius:6px; padding:8px 10px }
    .congress table { width:100%; border-collapse: collapse; font-size:14px }
    .congress th, .congress td { border-top:1px solid var(--ring); padding:8px 6px; text-align:left }
    .congress th { color:var(--muted); font-weight:600; text-transform:uppercase; letter-spacing:.05em }
    .badge { display:inline-block; font-size:11px; padding:2px 6px; margin-left:6px; border:1px solid var(--ring); border-radius:999px; color:#e5e7eb; background:#0f172a }
    .term-soon { color:#fbbf24 }
    .term-past { color:#f87171 }
    .congress h2 { margin: 0 0 10px; font-size:14px; color:var(--muted); text-transform:uppercase }
    .congress .controls { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px }
    .congress input, .congress select { background:#0f172a; color:var(--text); border:1px solid var(--ring); border-radius:6px; padding:8px 10px }
    .congress table { width:100%; border-collapse: collapse; font-size:14px }
    .congress th, .congress td { border-top:1px solid var(--ring); padding:8px 6px; text-align:left }
    .congress th { color:var(--muted); font-weight:600; text-transform:uppercase; letter-spacing:.05em }
    .term-soon { color:#fbbf24 }
    .term-past { color:#f87171 }
  </style>
  <!-- Optional: put your Congress.gov API key here for live member data -->
  <!-- <meta name="congress-api-key" content="YOUR_API_KEY_HERE"> -->
</head>
<body>
  <div class="gov-banner">
    <span class="flag">üá∫üá∏</span> Not an official website of the United States government
    <a id="gov-toggle">Here's how you know</a>
    <div class="gov-dropdown" id="gov-info">
      <div><strong>Websites use .gov</strong> <span class="desc">A .gov website belongs to a government organization in the United States.</span></div>
      <div><strong>Secure websites use HTTPS</strong> <span class="desc">A lock (üîí) or https:// means you‚Äôre safely connected. Share sensitive information only on secure sites.</span></div>
    </div>
  </div>

  <header>
    <div class="brand"><img src="logo.png" alt="NetWatch logo"/> NetWatch</div>
    <div style="position:relative; display:flex; align-items:center; gap:16px">
      <button class="weather" id="weatherBtn" aria-expanded="false" aria-controls="weatherPanel" title="Local weather">
        <span class="wx-icon" id="wx-icon">‚õÖ</span>
        <span class="wx-temp" id="wx-temp">--¬∞</span>
        <span class="wx-place" id="wx-place">Locating‚Ä¶</span>
        <span class="wx-caret">‚ñæ</span>
      </button>
      <div class="clock" id="clock">‚Äî:‚Äî ‚Äî</div>
      <div class="weather-panel" id="weatherPanel" role="dialog" aria-label="Weather details">
        <div class="weather-head">
          <div class="wx-meta" id="wx-meta">‚Äî</div>
          <div class="unit-toggle" role="group" aria-label="Units">
            <button id="uF" class="active" type="button">¬∞F</button>
            <button id="uC" type="button">¬∞C</button>
          </div>
        </div>
        <div class="forecast" id="wx-forecast"></div>
        <div class="daily" id="wx-daily"></div>
      </div>
    </div>
  </header>

  <nav class="topnav" aria-label="Primary">
    <div class="menu"><a href="#home">Home</a></div>
    <div class="menu"><a href="#programs">Programs</a>
      <div class="submenu" role="menu">
        <a href="#medicaid">Medicaid</a>
        <a href="#housing">Housing</a>
        <a href="#snap">SNAP / EBT</a>
        <a href="#social-security">Social Security</a>
      </div>
    </div>
    <div class="menu"><a href="#resources">Resources</a>
      <div class="submenu" role="menu">
        <a href="#laws">Federal Laws</a>
        <a href="#regs">Regulations</a>
        <a href="#reports">Reports</a>
        <a href="#cases">Case Studies</a>
      </div>
    </div>
    <div class="menu"><a href="#about">About</a>
      <div class="submenu" role="menu">
        <a href="#mission">Mission</a>
        <a href="#contact">Contact</a>
        <a href="#foia">FOIA</a>
      </div>
    </div>
  </nav>

  <main class="container" id="home">
    <h1 class="title">NetWatch ‚Äî Official Monitoring Portal</h1>
    <p class="subtitle">Government Monitoring & Information Dashboard</p>

    <div class="exec-wrapper">
      <section class="exec" aria-labelledby="exec-title">
        <img id="seal" alt="Seal of the President of the United States" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Seal_of_the_President_of_the_United_States.svg/240px-Seal_of_the_President_of_the_United_States.svg.png"/>
        <div>
          <h2 id="exec-title">Executive Tracker</h2>
          <dl class="grid">
            <dt>President</dt><dd>Donald J. Trump (47th)</dd>
            <dt>Vice President</dt><dd>JD Vance</dd>
            <dt>Term</dt><dd>January 20, 2025 ‚Äì January 20, 2029</dd>
            <dt>Last Update</dt><dd id="last-update">‚Äî</dd>
          </dl>
        </div>
      </section>

      <aside class="live-panel">
        <h2>Live Approval Ratings</h2>
        <!-- FiveThirtyEight presidential approval tracker embed -->
        <iframe title="Presidential Approval (FiveThirtyEight)" src="https://projects.fivethirtyeight.com/polls/president-approval/iframe/" loading="lazy"></iframe>

        <h2 style="margin-top:14px">Live Stock Market</h2>
        <!-- TradingView widgets: Ticker Tape + Symbol Overview (vertical) -->
        <div class="tradingview-widget-container" style="margin-bottom:8px">
          <div id="tv-ticker-tape"></div>
          <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>{
            "symbols": [
              {"proName": "FOREXCOM:SPXUSD", "title": "S&P 500"},
              {"proName": "NASDAQ:IXIC", "title": "Nasdaq"},
              {"proName": "DJI", "title": "Dow"},
              {"proName": "BINANCE:BTCUSDT", "title": "BTC"},
              {"proName": "BINANCE:ETHUSDT", "title": "ETH"}
            ],
            "showSymbolLogo": true,
            "isTransparent": true,
            "displayMode": "adaptive",
            "colorTheme": "dark"
          }</script>
        </div>
        <div class="tradingview-widget-container">
          <div id="tv-symbol-overview"></div>
          <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js" async>{
            "symbols": [["FOREXCOM:SPXUSD|1D"],["NASDAQ:IXIC|1D"],["DJI|1D"],["NASDAQ:AAPL|1D"],["NASDAQ:NVDA|1D"]],
            "chartOnly": false,
            "width": "100%",
            "height": 300,
            "locale": "en",
            "colorTheme": "dark",
            "autosize": true,
            "showVolume": false,
            "showMA": false,
            "lineWidth": 2,
            "isTransparent": true
          }</script>
        </div>
      </aside>
    </div>

    <section class="links" id="resources" aria-label="Key Links">
      <div class="block">
        <h3>Federal Agencies</h3>
        <a href="https://www.cms.gov/" target="_blank" rel="noopener">CMS<span class="ext">cms.gov ‚Üó</span></a>
        <a href="https://www.hud.gov/" target="_blank" rel="noopener">HUD<span class="ext">hud.gov ‚Üó</span></a>
        <a href="https://www.usda.gov/" target="_blank" rel="noopener">USDA<span class="ext">usda.gov ‚Üó</span></a>
        <a href="https://www.ssa.gov/" target="_blank" rel="noopener">SSA<span class="ext">ssa.gov ‚Üó</span></a>
        <a href="http://doj.gov/" target="_blank" rel="noopener">DOJ<span class="ext">doj.gov ‚Üó</span></a>
      </div>
      <div class="block">
        <h3>Official Registers</h3>
        <a href="https://www.federalregister.gov/" target="_blank" rel="noopener">Federal Register<span class="ext">federalregister.gov ‚Üó</span></a>
        <a href="https://www.congress.gov/" target="_blank" rel="noopener">Congress<span class="ext">congress.gov ‚Üó</span></a>
        <a href="https://www.govinfo.gov/" target="_blank" rel="noopener">GovInfo<span class="ext">govinfo.gov ‚Üó</span></a>
      </div>
      <div class="block">
        <h3>Programs</h3>
        <a href="#medicaid">Medicaid<span class="ext">internal ‚Üó</span></a>
        <a href="#housing">Housing<span class="ext">internal ‚Üó</span></a>
        <a href="#snap">SNAP / EBT<span class="ext">internal ‚Üó</span></a>
        <a href="#social-security">Social Security<span class="ext">internal ‚Üó</span></a>
      </div>
    </section>
      <section class="congress" id="congress">
      <h2>Members of Congress ‚Äî Live Directory</h2>
      <div class="controls">
        <input id="filterText" type="search" placeholder="Search name, state, party" aria-label="Filter" />
        <select id="filterChamber" aria-label="Chamber">
          <option value="">All Chambers</option>
          <option value="House">House</option>
          <option value="Senate">Senate</option>
        </select>
        <select id="filterState" aria-label="State"></select>
      </div>
      <div id="congressNote" style="color: var(--muted); font-size:13px; margin-bottom:6px"></div>
      <div style="overflow:auto">
        <table id="congressTable" aria-live="polite">
          <thead>
            <tr>
              <th>Name</th>
              <th>Chamber</th>
              <th>State/Dist.</th>
              <th>Party</th>
              <th>Term Ends</th>
              <th>Days Left</th>
              <th>Profile</th>
            </tr>
          </thead>
          <tbody><tr><td colspan="7" style="color:var(--muted)">Loading‚Ä¶</td></tr></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer>¬© <span id="year"></span> NetWatch ‚Ä¢ Atlanta, GA 30303</footer>

  <script>
    // ---- Clock & Last Update ----
    function setNow(){
      const y=document.getElementById('year'); if(y) y.textContent=new Date().getFullYear();
      const tz='America/Denver';
      const clock=document.getElementById('clock');
      const tf=new Intl.DateTimeFormat('en-US',{timeZone:tz,hour:'numeric',minute:'2-digit',second:'2-digit',hour12:true});
      const df=new Intl.DateTimeFormat('en-US',{timeZone:tz,year:'numeric',month:'numeric',day:'numeric'});
      const tick=()=>{ if(clock) clock.textContent=tf.format(new Date()); };
      tick(); setInterval(tick,1000);
      const lu=document.getElementById('last-update'); if(lu) lu.textContent=df.format(new Date());
    }

    // ---- Seal animation ----
    function spinSeal(){
      const seal=document.getElementById('seal'); if(!seal) return;
      const once=()=>{ seal.style.transition='transform 2.2s linear'; seal.style.transform='rotate(360deg)'; setTimeout(()=>{ seal.style.transform='rotate(0deg)'; },2300); };
      setTimeout(once,1200); setInterval(once,180000);
    }

    // ---- Weather (Open-Meteo, no key required) ----
    // Docs: https://open-meteo.com/en/docs (no API key) and current_weather field.
    function iconFromWeatherCode(code, isDay){
      const day = !!isDay;
      // Minimal mapping for clarity
      if(code===0) return day?'‚òÄÔ∏è':'üåô'; // clear
      if(code===1||code===2) return '‚õÖ'; // mainly/partly cloudy
      if(code===3) return '‚òÅÔ∏è'; // overcast
      if(code>=45&&code<=48) return 'üå´Ô∏è'; // fog
      if(code>=51&&code<=67) return 'üåßÔ∏è'; // drizzle/rain
      if(code>=71&&code<=77) return '‚ùÑÔ∏è'; // snow
      if(code>=80&&code<=82) return 'üå¶Ô∏è'; // showers
      if(code>=95) return '‚õàÔ∏è'; // thunder
      return 'üå°Ô∏è';
    }

    async function fetchWeather(lat, lon, unit){
      const tempUnit = unit==='celsius' ? 'celsius' : 'fahrenheit';
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m,precipitation_probability,weathercode&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=${tempUnit}&timezone=auto`;
      const wxIcon=document.getElementById('wx-icon');
      const wxTemp=document.getElementById('wx-temp');
      const wxPlace=document.getElementById('wx-place');
      const wxMeta=document.getElementById('wx-meta');
      const boxH=document.getElementById('wx-forecast');
      const boxD=document.getElementById('wx-daily');
      try{
        const r = await fetch(url, {cache:'no-store'});
        const j = await r.json();
        const cw = j.current_weather;
        if(cw){
          wxIcon.textContent = iconFromWeatherCode(cw.weathercode, cw.is_day);
          wxTemp.textContent = Math.round(cw.temperature) + (tempUnit==='celsius'?'¬∞C':'¬∞F');
          wxPlace.textContent = j.timezone_abbreviation || 'Local';
          wxMeta.textContent = `Wind ${Math.round(cw.windspeed)} ${j.current_weather_units?.windspeed||'km/h'}`;
        }
        // Render next 8 hours
        boxH.innerHTML = '';
        if(j.hourly && j.hourly.time){
          const now = Date.now();
          const items = [];
          for(let i=0;i<j.hourly.time.length;i++){
            const t = new Date(j.hourly.time[i]).getTime();
            if(t >= now && items.length<8){
              items.push({
                time: new Date(t).toLocaleTimeString([], {hour:'numeric'}),
                temp: Math.round(j.hourly.temperature_2m[i]),
                pop: j.hourly.precipitation_probability ? j.hourly.precipitation_probability[i] : null,
                code: j.hourly.weathercode ? j.hourly.weathercode[i] : null
              });
            }
          }
          boxH.innerHTML = items.map(it=>`<div class="chip"><div class="t">${it.time}</div><div class="v">${it.temp}¬∞</div><div class="t">${it.pop??0}% ‚Ä¢ ${iconFromWeatherCode(it.code,1)}</div></div>`).join('');
        }
        // Render next 3 days
        boxD.innerHTML = '';
        if(j.daily && j.daily.time){
          const rows = j.daily.time.slice(0,3).map((d,idx)=>{
            const hi = Math.round(j.daily.temperature_2m_max[idx]);
            const lo = Math.round(j.daily.temperature_2m_min[idx]);
            const ic = iconFromWeatherCode(j.daily.weathercode[idx], 1);
            const lbl = new Date(d).toLocaleDateString([], {weekday:'short'});
            return `<div class="row">${lbl}<div style="font-size:18px">${ic}</div><div>${lo}¬∞ / <strong>${hi}¬∞</strong></div></div>`;
          }).join('');
          boxD.innerHTML = rows;
        }
      }catch(e){ wxPlace.textContent = 'Weather unavailable'; }
    }&longitude=${lon}&current_weather=true&temperature_unit=fahrenheit&timezone=auto`;
      const wxIcon=document.getElementById('wx-icon');
      const wxTemp=document.getElementById('wx-temp');
      const wxPlace=document.getElementById('wx-place');
      try{
        const r = await fetch(url, {cache:'no-store'});
        const j = await r.json();
        const cw = j.current_weather;
        if(cw){
          wxIcon.textContent = iconFromWeatherCode(cw.weathercode, cw.is_day);
          wxTemp.textContent = Math.round(cw.temperature) + '¬∞F';
          wxPlace.textContent = j.timezone_abbreviation || 'Local';
        }
      }catch(e){ wxPlace.textContent = 'Weather unavailable'; }
    }

    function initWeather(){
      const fallback = {lat:33.7490, lon:-84.3880, label:'Atlanta'};
      const wxPlace=document.getElementById('wx-place');
      const panel = document.getElementById('weatherPanel');
      const btn = document.getElementById('weatherBtn');
      const uF = document.getElementById('uF');
      const uC = document.getElementById('uC');
      let unit = 'fahrenheit';
      const refresh = (lat,lon)=>{ fetchWeather(lat,lon,unit); setInterval(()=>fetchWeather(lat,lon,unit), 10*60*1000); };

      // Toggle panel
      if(btn && panel){
        btn.addEventListener('click', ()=>{
          const open = panel.classList.toggle('open');
          btn.setAttribute('aria-expanded', open?'true':'false');
        });
        document.addEventListener('click', (e)=>{ if(!panel.contains(e.target) && !btn.contains(e.target)) panel.classList.remove('open'); }, {capture:true});
      }
      // Unit toggles
      if(uF && uC){
        uF.addEventListener('click', ()=>{ unit='fahrenheit'; uF.classList.add('active'); uC.classList.remove('active'); reFetch(); });
        uC.addEventListener('click', ()=>{ unit='celsius'; uC.classList.add('active'); uF.classList.remove('active'); reFetch(); });
      }
      let last = fallback;
      const reFetch = ()=> refresh(last.lat,last.lon);

      if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(pos=>{
          last = {lat:pos.coords.latitude, lon:pos.coords.longitude, label:'Local'};
          if(wxPlace) wxPlace.textContent='Local';
          refresh(last.lat,last.lon);
        }, err=>{
          if(wxPlace) wxPlace.textContent=fallback.label;
          last = fallback; refresh(last.lat,last.lon);
        }, {enableHighAccuracy:false, timeout:7000, maximumAge:10*60*1000});
      } else {
        if(wxPlace) wxPlace.textContent=fallback.label;
        last = fallback; refresh(last.lat,last.lon);
      }
    };
      const wxPlace=document.getElementById('wx-place');
      if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(pos=>{
          const {latitude, longitude} = pos.coords;
          if(wxPlace) wxPlace.textContent='Locating‚Ä¶';
          fetchWeather(latitude, longitude);
          // refresh every 10 minutes
          setInterval(()=>fetchWeather(latitude, longitude), 10*60*1000);
        }, err=>{
          if(wxPlace) wxPlace.textContent=fallback.label;
          fetchWeather(fallback.lat, fallback.lon);
          setInterval(()=>fetchWeather(fallback.lat, fallback.lon), 10*60*1000);
        }, {enableHighAccuracy:false, timeout:7000, maximumAge:10*60*1000});
      } else {
        if(wxPlace) wxPlace.textContent=fallback.label;
        fetchWeather(fallback.lat, fallback.lon);
        setInterval(()=>fetchWeather(fallback.lat, fallback.lon), 10*60*1000);
      }
    }

    // ---- Congress table (fixed malformed block & daily refresh) ----
    async function buildCongress(){
      const key = (document.querySelector('meta[name="congress-api-key"]')||{}).content;
      const note = document.getElementById('congressNote');
      const tbody = document.querySelector('#congressTable tbody');
      const congressNumber = 119; // current congress (configured here)
      if(!tbody) return;
      let members=[];
      if(key){
        try{
          const pageSize = 250; let offset = 0; let keep=true; let page=0;
          while(keep && page<20){
            const url = `https://api.congress.gov/v3/member/congress/${congressNumber}?currentMember=true&limit=${pageSize}&offset=${offset}&format=json&api_key=${key}`;
            const resp = await fetch(url);
            if(!resp.ok) break;
            const json = await resp.json();
            const chunk = (json.members||[]).map(m=>({
              name: m.fullName,
              chamber: m.chamber,
              state: m.state + (m.district?`-${m.district}`:''),
              party: m.party,
              start: m.startDate,
              end: m.endDate,
              url: m.url,
              leadership: m.leadershipTitle || m.leadershipRole || ''
            }));
            members.push(...chunk);
            if(json.pagination && json.pagination.next){ offset += pageSize; page++; } else { keep=false; }
          }
        }catch(e){ console.error(e); }
      }
      if(!members.length){
        note.innerHTML = 'Live member data uses the official Congress.gov API. Add your API key in <code>&lt;meta name="congress-api-key"&gt;</code> to enable real-time updates. In the meantime, static links to the official directories are below.';
        tbody.innerHTML = `<tr><td colspan="7"><a href="https://www.senate.gov/senators/" target="_blank" rel="noopener">Senators directory</a> ¬∑ <a href="https://www.house.gov/representatives" target="_blank" rel="noopener">Representatives directory</a></td></tr>`;
        return;
      }
      const stateSelect = document.getElementById('filterState');
      const stateSet = new Set(members.map(m=>m.state.split('-')[0]));
      const states = Array.from(stateSet).sort();
      if(stateSelect){ stateSelect.innerHTML = `<option value="">All States</option>` + states.map(s=>`<option value="${s}">${s}</option>`).join(''); }

      const rows = members.map(m=>{
        const end = m.end ? new Date(m.end) : null;
        const today = new Date();
        const daysLeft = end ? Math.ceil((end - today)/86400000) : '';
        const cls = daysLeft!=='' && daysLeft<=120 ? 'term-soon' : '';
        const badge = m.leadership ? `<span class=\"badge\">${m.leadership}</span>` : '';
        return `<tr>
          <td>${m.name} ${badge}</td>
          <td>${m.chamber}</td>
          <td>${m.state}</td>
          <td>${m.party}</td>
          <td>${m.end? new Date(m.end).toLocaleDateString():''}</td>
          <td class=\"${cls}\">${daysLeft}</td>
          <td><a href=\"${m.url}\" target=\"_blank\" rel=\"noopener\">Profile ‚Üó</a></td>
        </tr>`;
      }).join('');
      tbody.innerHTML = rows;

      const filterText = document.getElementById('filterText');
      const filterChamber = document.getElementById('filterChamber');
      const filterState = document.getElementById('filterState');
      const applyFilter = ()=>{
        const q = (filterText.value||'').toLowerCase();
        const ch = filterChamber.value;
        const st = filterState.value;
        for(const tr of tbody.querySelectorAll('tr')){
          const name = tr.children[0].textContent.toLowerCase();
          const chamber = tr.children[1].textContent;
          const state = tr.children[2].textContent;
          const party = tr.children[3].textContent.toLowerCase();
          const matchesText = !q || name.includes(q) || party.includes(q) || state.toLowerCase().includes(q);
          const matchesChamber = !ch || chamber===ch;
          const matchesState = !st || state.startsWith(st);
          tr.style.display = (matchesText && matchesChamber && matchesState) ? '' : 'none';
        }
      };
      filterText.addEventListener('input', applyFilter);
      filterChamber.addEventListener('change', applyFilter);
      filterState.addEventListener('change', applyFilter);
      setTimeout(buildCongress, 24*60*60*1000); // daily refresh
    }

    // ---- Init ----
    window.addEventListener('DOMContentLoaded',()=>{
      setNow();
      spinSeal();
      // gov banner toggle
      const toggle=document.getElementById('gov-toggle');
      const info=document.getElementById('gov-info');
      if(toggle && info){ toggle.addEventListener('click',()=> info.classList.toggle('open')); }
      // refresh 538 approval iframe every 30 min
      const fte = document.querySelector('iframe[title^="Presidential Approval"]');
      if (fte) { setInterval(()=>{ const u=new URL(fte.src); u.searchParams.set('t', Date.now()); fte.src=u.toString(); }, 1800000); }
      // weather
      initWeather();
      // congress
      buildCongress();
    });
  </script>
</body>
</html>

